# -*- coding: utf-8 -*-
"""Smart_Phone_Price_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1rssPiX9Mm5UcN0ulCx6qpn-RG4BnoBM6

**Problem Statement: Smart Phone Price Prediction System

In today’s market, there are many smartphone brands and models available, such as Samsung, Apple, Xiaomi, Realme, Oppo, and others. Each phone comes with different features like RAM, storage, camera quality, battery capacity, processor, and display size. Because of this wide variety, it becomes difficult for customers to choose the right smartphone according to their needs and budget.

Many buyers do not have detailed technical knowledge about smartphone specifications. They usually only know brand names, but they are not sure which model is best for their requirements. As a result, they may end up buying a phone that is either too expensive or does not meet their expectations.

The aim of this project is to develop a Smart Phone Price Prediction System using Machine Learning. This system will take user inputs such as brand preference, budget, RAM, storage, camera, battery, and other specifications. Based on these inputs, the model will predict the estimated price of the smartphone and help the user understand which type of phone would be suitable.

This project will use a dataset of various smartphone models and their specifications. A machine learning algorithm will be trained on this data to learn the relationship between phone features and price. The trained model will then be used to predict prices for new user inputs.

The main objective of this system is to assist customers in making better purchasing decisions by providing price predictions based on their requirements.**

# **Dataset Load**
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv("smartphone_dataset_large.csv")
df.head()

"""# **Show Last 5 Record**"""

df.tail()

"""# **Dataset Shape Check**"""

df.shape

"""# **Column Names**"""

df.columns

"""# **Dataset Information**"""

df.info()

"""# **Statistical Summary**"""

df.describe()

"""# **Task 2**

# **Target Variable: Price_INR**
"""

plt.figure(figsize=(8,5))
sns.histplot(df["Price_INR"], bins=30, kde=True)
plt.title("Smartphone Price Distribution")
plt.xlabel("Price (INR)")
plt.ylabel("Count")
plt.show()

"""# **RAM_GB Analysis**"""

plt.figure(figsize=(7,5))
sns.countplot(x="RAM_GB", data=df)
plt.title("RAM Distribution in Smartphones")
plt.show()

"""# **Camera_MP Analysis**"""

plt.figure(figsize=(7,5))
sns.countplot(x="Camera_MP", data=df)
plt.title("Camera MP Distribution")
plt.show()

"""# **Battery_mAh Analysis**"""

plt.figure(figsize=(7,5))
sns.countplot(x="Battery_mAh", data=df)
plt.title("Battery Capacity Distribution")
plt.show()

"""# **Brand Distribution**"""

plt.figure(figsize=(8,5))
sns.countplot(x="Brand", data=df)
plt.title("Smartphone Brand Distribution")
plt.xticks(rotation=45)
plt.show()

"""# ***BIVARIATE ANALYSIS***

# **RAM_GB vs Price_INR**
"""

plt.figure(figsize=(8,5))
sns.boxplot(x="RAM_GB", y="Price_INR", data=df)
plt.title("RAM vs Smartphone Price")
plt.show()

"""# **Storage_GB vs Price_INR**"""

plt.figure(figsize=(8,5))
sns.boxplot(x="Storage_GB", y="Price_INR", data=df)
plt.title("Storage vs Smartphone Price")
plt.show()

"""# **Camera_MP vs Price_INR**"""

plt.figure(figsize=(8,5))
sns.boxplot(x="Camera_MP", y="Price_INR", data=df)
plt.title("Camera MP vs Smartphone Price")
plt.show()

"""# **Battery_mAh vs Price_INR**"""

plt.figure(figsize=(8,5))
sns.scatterplot(x="Battery_mAh", y="Price_INR", data=df)
plt.title("Battery vs Smartphone Price")
plt.show()

plt.figure(figsize=(8,5))
sns.boxplot(x="Battery_mAh", y="Price_INR", data=df)
plt.title("Battery vs Smartphone Price")
plt.show()

"""# **Brand vs Price_INR**"""

plt.figure(figsize=(8,5))
sns.boxplot(x="Brand", y="Price_INR", data=df)
plt.xticks(rotation=45)
plt.title("Brand vs Smartphone Price")
plt.show()

"""# ***MULTIVARIATE ANALYSIS***

# **Correlation Heatmap (Numerical Features)**
"""

plt.figure(figsize=(10,6))
sns.heatmap(
    df[["RAM_GB", "Storage_GB", "Camera_MP", "Battery_mAh", "Screen_Size", "Price_INR"]]
    .corr(),
    annot=True,
    cmap="coolwarm"
)
plt.title("Correlation Heatmap - Smartphone Features")
plt.show()

"""# **RAM + Camera + Price (3 Variables)**"""

plt.figure(figsize=(8,5))
sns.scatterplot(
    x="RAM_GB",
    y="Price_INR",
    hue="Camera_MP",
    data=df
)
plt.title("RAM vs Price with Camera MP")
plt.show()

plt.figure(figsize=(8,5))
sns.boxplot(
    x="RAM_GB",
    y="Price_INR",
    hue="Camera_MP",
    data=df
)
plt.title("RAM vs Price with Camera MP")
plt.show()

"""# **Brand + RAM + Price**"""

plt.figure(figsize=(8,5))
sns.boxplot(
    x="Brand",
    y="Price_INR",
    hue="RAM_GB",
    data=df
)
plt.xticks(rotation=45)
plt.title("Brand, RAM and Price Relationship")
plt.show()

"""# **5G Support vs Price (Extra but Useful)**"""

plt.figure(figsize=(10,6))
sns.boxplot(x="5G", y="Price_INR", data=df)
plt.title("5G Support vs Price")
plt.show()

"""# **CATEGORICAL DATA ANALYSIS**

**Brand Analysis**
"""

plt.figure(figsize=(8,6))
sns.countplot(x="Brand", data=df)
plt.title("Number of Phones per Brand")
plt.xticks(rotation=45)
plt.show()

"""# **Series Analysis**"""

plt.figure(figsize=(10,5))
sns.countplot(x="Series", data=df)
plt.title("Phone Count per Series")
plt.xticks(rotation=60)
plt.show()

"""# **Processor Analysis**"""

plt.figure(figsize=(10,5))
sns.countplot(x="Processor", data=df)
plt.title("Processor Distribution")
plt.show()

"""***Processor vs Price***"""

plt.figure(figsize=(10,5))
sns.boxplot(x="Processor", y="Price_INR", data=df)
plt.title("Processor vs Price")
plt.show()

"""# ***FEATURE ENCODING***

# **Categorical Columns Identify**
"""

categorical_cols = ["Brand", "Series", "Processor"]

"""# **One-Hot Encoding Apply**"""

df_encoded = pd.get_dummies(
    df,
    columns=categorical_cols,
    drop_first=True
)

df_encoded.head()

"""# **Model_Name Column Drop**"""

df_encoded = df_encoded.drop("Model_Name", axis=1)

"""# **Final Encoded Dataset Check**"""

df_encoded.info()

"""# **CORRELATION WITH TARGET**

# **Correlation Matrix**
"""

corr_matrix = df_encoded.corr()
corr_matrix.head()

"""# **Price Correlation**"""

price_corr = corr_matrix["Price_INR"].sort_values(ascending=False)
price_corr

"""# **Price Correlation Graph**"""

plt.figure(figsize=(8,10))
price_corr.drop("Price_INR").plot(kind="barh")
plt.title("Feature Correlation with Smartphone Price")
plt.show()

"""# **Model Training**"""

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import numpy as np

# Separate features (X) and target (y)
X = df_encoded.drop("Price_INR", axis=1)
y = df_encoded["Price_INR"]

# Split data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(
X    , y, test_size=0.2, random_state=42
)

# Model create करना
model = LinearRegression()

# Model को train करना
model.fit(X_train, y_train)

# Prediction करना
y_pred = model.predict(X_test)

# Evaluate the model
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

print(f"Mean Absolute Error (MAE): {mae:.2f}")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"Root Mean Squared Error (RMSE): {rmse:.2f}")
print(f"R-squared (R2): {r2:.2f}")

"""# **Model creat**"""

model = LinearRegression()

"""# **Model train**"""

model.fit(X_train, y_train)

"""# **Prediction**"""

y_pred = model.predict(X_test)

import pandas as pd

results = pd.DataFrame({
    "Actual Price": y_test,
    "Predicted Price": y_pred
})

results.head()

"""# **Model Evaluation**

# ***User Input Prediction System***
"""

# User input
brand = input("Enter Brand (Samsung, Apple, Xiaomi, etc): ")
series = input("Enter Series (Galaxy, iPhone, Redmi, etc): ")
ram = int(input("Enter RAM (GB): "))
storage = int(input("Enter Storage (GB): "))
camera = int(input("Enter Camera (MP): "))
battery = int(input("Enter Battery (mAh): "))
display = float(input("Enter Display Size (inches): "))
processor = input("Enter Processor: ")
is_5g = input("5G Support? (Yes/No): ")

# User input ko dataframe banana
user_data = pd.DataFrame([[
    brand, series, ram, storage, camera,
    battery, display, processor, is_5g
]], columns=[
    "Brand", "Series", "RAM_GB", "Storage_GB",
    "Camera_MP", "Battery_mAh", "Display_inch",
    "Processor", "5G"
])

user_data['5G'] = user_data['5G'].apply(lambda x: 1 if x.lower() == 'yes' else 0)
user_data = user_data.rename(columns={'Display_inch': 'Screen_Size'})

# Get the categorical columns used for encoding in the original dataframe
categorical_cols_for_user_data = ['Brand', 'Series', 'Processor']

# Apply one-hot encoding to user input
user_data_encoded = pd.get_dummies(
    user_data,
    columns=categorical_cols_for_user_data,
    drop_first=True
)

# Ensure all columns from the training data (X_train) are present in the user input data
# Fill missing columns with 0 and reorder them to match X_train
user_data_final = user_data_encoded.reindex(columns=X_train.columns, fill_value=0)

# Drop the 'Model_Name' if it exists, though it shouldn't be in user_data
# if 'Model_Name' in user_data_final.columns:
#     user_data_final = user_data_final.drop('Model_Name', axis=1)

# Predict the price
predicted_price = model.predict(user_data_final)

print(f"Predicted Price for the smartphone: {predicted_price[0]:.2f} INR")

model = LinearRegression()
model.fit(X_train, y_train)

import pickle

pickle.dump(model, open("smartphone_model.pkl", "wb"))

# pickle.dump(le, open("label_encoder.pkl", "wb"))

import os
print(os.listdir())

from google.colab import files
files.download("smartphone_model.pkl")